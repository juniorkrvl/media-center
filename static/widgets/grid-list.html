<dom-module id="grid-list">
    <template>
        <style>
            :host{
                @apply(--layout-vertical);
                height:auto;
            }
        </style>
        <content></content>
    </template>
    <script>
        Polymer({
            is: 'grid-list',
            properties:{
                columns:Number
            },
            behaviors:[
                MCBehaviors.NavigableBehavior
            ],
            _onRight: function(manager){
                this.redirectToRow(manager,'_onRight');
            },
            _onLeft: function(manager){
                this.redirectToRow(manager,'_onLeft');
            },
            _onDown: function(manager){
                this.redirectToRow(manager,'_onDown');
            },
            _onUp: function(manager){
                this.redirectToRow(manager,'_onUp');
            },

            redirectToRow:function(manager,func){
                var gridRow = manager.focusedItem.parentElement; 
                if(gridRow){
                    manager._focusGroup(gridRow);
                    if(gridRow[func]){
                        gridRow[func](manager);
                    }
                }
            },
            
            ready:function(){
                this.focusRole = 'group';
                this.focusType = 'grid';

                var children = this.queryAllEffectiveChildren('[focus-role="item"]');
                for(c in children){
                    Polymer.dom(this).removeChild(children[c]);
                }

                var item = 0;
                var row;

                for(c in children){
                    
                    if(item==0){
                        row = document.createElement('grid-row');
                        Polymer.dom(this).appendChild(row);
                    }
                    
                    if(item<this.columns){
                        Polymer.dom(row).appendChild(children[c]);
                        item+=1;

                        if(item==this.columns){
                            item=0;
                        }
                    }

                    if(item < this.columns &&  c == children.length-1){
                        while(item < this.columns){
                            var fill = document.createElement('div');
                            Polymer.dom(row).appendChild(fill);
                            item+=1
                            console.log('+1');
                        }
                    }
                }

                Polymer.updateStyles();

            }

        });
    </script>
</dom-module>